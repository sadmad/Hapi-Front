{"version":3,"sources":["../src/useForm/index.ts","../src/useStepsForm/index.ts","../src/useModalForm/index.ts"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport get from \"lodash-es/get.js\";\nimport has from \"lodash-es/has.js\";\n\nimport {\n  useForm as useHookForm,\n  type UseFormProps as UseHookFormProps,\n  type UseFormReturn,\n  type FieldValues,\n  type UseFormHandleSubmit,\n  type Path,\n} from \"react-hook-form\";\nimport {\n  type BaseRecord,\n  type HttpError,\n  useForm as useFormCore,\n  useWarnAboutChange,\n  type UseFormProps as UseFormCoreProps,\n  type UseFormReturnType as UseFormReturnTypeCore,\n  useTranslate,\n  useRefineContext,\n  flattenObjectKeys,\n} from \"@refinedev/core\";\n\nexport type UseFormReturnType<\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n> = UseFormReturn<TVariables, TContext> & {\n  refineCore: UseFormReturnTypeCore<\n    TQueryFnData,\n    TError,\n    TVariables,\n    TData,\n    TResponse,\n    TResponseError\n  >;\n  saveButtonProps: {\n    disabled: boolean;\n    onClick: (e: React.BaseSyntheticEvent) => void;\n  };\n};\n\nexport type UseFormProps<\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n> = {\n  /**\n   * Configuration object for the core of the [useForm](/docs/api-reference/core/hooks/useForm/)\n   * @type [`UseFormCoreProps<TQueryFnData, TError, TVariables, TData, TResponse, TResponseError>`](/docs/api-reference/core/hooks/useForm/#properties)\n   */\n  refineCoreProps?: UseFormCoreProps<\n    TQueryFnData,\n    TError,\n    TVariables,\n    TData,\n    TResponse,\n    TResponseError\n  >;\n  /**\n   * When you have unsaved changes and try to leave the current page, **refine** shows a confirmation modal box.\n   * @default `false*`\n   */\n  warnWhenUnsavedChanges?: boolean;\n  /**\n   * Disables server-side validation\n   * @default false\n   * @see {@link https://refine.dev/docs/advanced-tutorials/forms/server-side-form-validation/}\n   */\n  disableServerSideValidation?: boolean;\n} & UseHookFormProps<TVariables, TContext>;\n\nexport const useForm = <\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n>({\n  refineCoreProps,\n  warnWhenUnsavedChanges: warnWhenUnsavedChangesProp,\n  disableServerSideValidation: disableServerSideValidationProp = false,\n  ...rest\n}: UseFormProps<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> = {}): UseFormReturnType<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> => {\n  const { options } = useRefineContext();\n  const disableServerSideValidation =\n    options?.disableServerSideValidation || disableServerSideValidationProp;\n\n  const translate = useTranslate();\n\n  const { warnWhenUnsavedChanges: warnWhenUnsavedChangesRefine, setWarnWhen } =\n    useWarnAboutChange();\n  const warnWhenUnsavedChanges =\n    warnWhenUnsavedChangesProp ?? warnWhenUnsavedChangesRefine;\n\n  const useHookFormResult = useHookForm<TVariables, TContext>({\n    ...rest,\n  });\n\n  const {\n    watch,\n    setValue,\n    getValues,\n    handleSubmit: handleSubmitReactHookForm,\n    setError,\n  } = useHookFormResult;\n\n  const useFormCoreResult = useFormCore<\n    TQueryFnData,\n    TError,\n    TVariables,\n    TData,\n    TResponse,\n    TResponseError\n  >({\n    ...refineCoreProps,\n    onMutationError: (error, _variables, _context) => {\n      if (disableServerSideValidation) {\n        refineCoreProps?.onMutationError?.(error, _variables, _context);\n        return;\n      }\n\n      const errors = error?.errors;\n\n      for (const key in errors) {\n        // when the key is not registered in the form, react-hook-form not working\n        const isKeyInVariables = Object.keys(\n          flattenObjectKeys(_variables),\n        ).includes(key);\n\n        if (!isKeyInVariables) {\n          continue;\n        }\n\n        const fieldError = errors[key];\n\n        let newError = \"\";\n\n        if (Array.isArray(fieldError)) {\n          newError = fieldError.join(\" \");\n        }\n\n        if (typeof fieldError === \"string\") {\n          newError = fieldError;\n        }\n\n        if (typeof fieldError === \"boolean\" && fieldError) {\n          newError = \"Field is not valid.\";\n        }\n\n        if (typeof fieldError === \"object\" && \"key\" in fieldError) {\n          const translatedMessage = translate(\n            fieldError.key,\n            fieldError.message,\n          );\n\n          newError = translatedMessage;\n        }\n\n        setError(key as Path<TVariables>, {\n          message: newError,\n        });\n      }\n\n      refineCoreProps?.onMutationError?.(error, _variables, _context);\n    },\n  });\n\n  const { query, onFinish, formLoading, onFinishAutoSave } = useFormCoreResult;\n\n  useEffect(() => {\n    const data = query?.data?.data;\n    if (!data) return;\n\n    /**\n     * get registered fields from react-hook-form\n     */\n    const registeredFields = Object.keys(flattenObjectKeys(getValues()));\n\n    /**\n     * set values from query result as default values\n     */\n    registeredFields.forEach((path) => {\n      const hasValue = has(data, path);\n      const dataValue = get(data, path);\n\n      /**\n       * set value if the path exists in the query result even if the value is null\n       */\n      if (hasValue) {\n        setValue(path as Path<TVariables>, dataValue);\n      }\n    });\n  }, [query?.data, setValue, getValues]);\n\n  useEffect(() => {\n    const subscription = watch((values: any, { type }: { type?: any }) => {\n      if (type === \"change\") {\n        onValuesChange(values);\n      }\n    });\n    return () => subscription.unsubscribe();\n  }, [watch]);\n\n  const onValuesChange = (changeValues: TVariables) => {\n    if (warnWhenUnsavedChanges) {\n      setWarnWhen(true);\n    }\n\n    if (refineCoreProps?.autoSave) {\n      setWarnWhen(false);\n\n      const onFinishProps =\n        refineCoreProps.autoSave?.onFinish ?? ((values: TVariables) => values);\n\n      return onFinishAutoSave(onFinishProps(changeValues)).catch(\n        (error) => error,\n      );\n    }\n\n    return changeValues;\n  };\n\n  const handleSubmit: UseFormHandleSubmit<TVariables> =\n    (onValid, onInvalid) => async (e) => {\n      setWarnWhen(false);\n      return handleSubmitReactHookForm(onValid, onInvalid)(e);\n    };\n\n  const saveButtonProps = {\n    disabled: formLoading,\n    onClick: (e: React.BaseSyntheticEvent) => {\n      handleSubmit(\n        (v) => onFinish(v).catch(() => {}),\n        () => false,\n      )(e);\n    },\n  };\n\n  return {\n    ...useHookFormResult,\n    handleSubmit,\n    refineCore: useFormCoreResult,\n    saveButtonProps,\n  };\n};\n","import { useEffect, useState } from \"react\";\nimport type { FieldValues, Path } from \"react-hook-form\";\nimport type { BaseRecord, HttpError } from \"@refinedev/core\";\nimport get from \"lodash-es/get.js\";\n\nimport { useForm, type UseFormProps, type UseFormReturnType } from \"../useForm\";\n\nexport type UseStepsFormReturnType<\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n> = UseFormReturnType<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> & {\n  steps: {\n    currentStep: number;\n    gotoStep: (step: number) => void;\n  };\n};\n\nexport type UseStepsFormProps<\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n> = UseFormProps<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> & {\n  /**\n     * @description Configuration object for the steps.\n     * `defaultStep`: Allows you to set the initial step.\n     * \n     * `isBackValidate`: Whether to validation the current step when going back.\n     * @type `{\n      defaultStep?: number;\n      isBackValidate?: boolean;\n      }`\n     * @default `defaultStep = 0` `isBackValidate = false`\n     */\n  stepsProps?: {\n    defaultStep?: number;\n    isBackValidate?: boolean;\n  };\n};\n\nexport const useStepsForm = <\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n>({\n  stepsProps,\n  ...rest\n}: UseStepsFormProps<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> = {}): UseStepsFormReturnType<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> => {\n  const { defaultStep = 0, isBackValidate = false } = stepsProps ?? {};\n  const [current, setCurrent] = useState(defaultStep);\n\n  const useHookFormResult = useForm<\n    TQueryFnData,\n    TError,\n    TVariables,\n    TContext,\n    TData,\n    TResponse,\n    TResponseError\n  >({\n    ...rest,\n  });\n\n  const {\n    trigger,\n    getValues,\n    setValue,\n    formState: { dirtyFields },\n    refineCore: { query },\n  } = useHookFormResult;\n\n  useEffect(() => {\n    const data = query?.data?.data;\n    if (!data) return;\n\n    const registeredFields = Object.keys(getValues());\n\n    console.log({\n      dirtyFields,\n      registeredFields,\n      data,\n    });\n\n    Object.entries(data).forEach(([key, value]) => {\n      const name = key as Path<TVariables>;\n\n      if (registeredFields.includes(name)) {\n        if (!get(dirtyFields, name)) {\n          setValue(name, value);\n        }\n      }\n    });\n  }, [query?.data, current, setValue, getValues]);\n\n  const go = (step: number) => {\n    let targetStep = step;\n\n    if (step < 0) {\n      targetStep = 0;\n    }\n\n    setCurrent(targetStep);\n  };\n\n  const gotoStep = async (step: number) => {\n    if (step === current) {\n      return;\n    }\n\n    if (step < current && !isBackValidate) {\n      go(step);\n      return;\n    }\n\n    const isValid = await trigger();\n    if (isValid) {\n      go(step);\n    }\n  };\n\n  return {\n    ...useHookFormResult,\n    steps: {\n      currentStep: current,\n      gotoStep,\n    },\n  };\n};\n","import { useCallback } from \"react\";\nimport {\n  type BaseKey,\n  type BaseRecord,\n  type FormWithSyncWithLocationParams,\n  type HttpError,\n  useGo,\n  useModal,\n  useParsed,\n  useResource,\n  useUserFriendlyName,\n  useTranslate,\n  useWarnAboutChange,\n  useInvalidate,\n} from \"@refinedev/core\";\nimport type { FieldValues } from \"react-hook-form\";\n\nimport { useForm, type UseFormProps, type UseFormReturnType } from \"../useForm\";\nimport React from \"react\";\n\nexport type UseModalFormReturnType<\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n> = UseFormReturnType<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> & {\n  modal: {\n    submit: (values: TVariables) => void;\n    close: () => void;\n    show: (id?: BaseKey) => void;\n    visible: boolean;\n    title: string;\n  };\n};\n\nexport type UseModalFormProps<\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n> = UseFormProps<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> & {\n  /**\n     * @description Configuration object for the modal.\n     * `defaultVisible`: Initial visibility state of the modal.\n     * \n     * `autoSubmitClose`: Whether the form should be submitted when the modal is closed.\n     * \n     * `autoResetForm`: Whether the form should be reset when the form is submitted.\n     * @type `{\n      defaultVisible?: boolean;\n      autoSubmitClose?: boolean;\n      autoResetForm?: boolean;\n      }`\n     * @default `defaultVisible = false` `autoSubmitClose = true` `autoResetForm = true`\n     */\n  modalProps?: {\n    defaultVisible?: boolean;\n    autoSubmitClose?: boolean;\n    autoResetForm?: boolean;\n  };\n} & FormWithSyncWithLocationParams;\n\nexport const useModalForm = <\n  TQueryFnData extends BaseRecord = BaseRecord,\n  TError extends HttpError = HttpError,\n  TVariables extends FieldValues = FieldValues,\n  TContext extends object = {},\n  TData extends BaseRecord = TQueryFnData,\n  TResponse extends BaseRecord = TData,\n  TResponseError extends HttpError = TError,\n>({\n  modalProps,\n  refineCoreProps,\n  syncWithLocation,\n  ...rest\n}: UseModalFormProps<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> = {}): UseModalFormReturnType<\n  TQueryFnData,\n  TError,\n  TVariables,\n  TContext,\n  TData,\n  TResponse,\n  TResponseError\n> => {\n  const invalidate = useInvalidate();\n  const [initiallySynced, setInitiallySynced] = React.useState(false);\n\n  const translate = useTranslate();\n\n  const { resource: resourceProp, action: actionProp } = refineCoreProps ?? {};\n\n  const {\n    resource,\n    action: actionFromParams,\n    identifier,\n  } = useResource(resourceProp);\n\n  const parsed = useParsed();\n  const go = useGo();\n  const getUserFriendlyName = useUserFriendlyName();\n\n  const action = actionProp ?? actionFromParams ?? \"\";\n\n  const syncingId = !(\n    typeof syncWithLocation === \"object\" && syncWithLocation?.syncId === false\n  );\n\n  const syncWithLocationKey =\n    typeof syncWithLocation === \"object\" && \"key\" in syncWithLocation\n      ? syncWithLocation.key\n      : resource && action && syncWithLocation\n        ? `modal-${identifier}-${action}`\n        : undefined;\n\n  const {\n    defaultVisible = false,\n    autoSubmitClose = true,\n    autoResetForm = true,\n  } = modalProps ?? {};\n\n  const useHookFormResult = useForm<\n    TQueryFnData,\n    TError,\n    TVariables,\n    TContext,\n    TData,\n    TResponse,\n    TResponseError\n  >({\n    refineCoreProps: {\n      ...refineCoreProps,\n      meta: {\n        ...(syncWithLocationKey ? { [syncWithLocationKey]: undefined } : {}),\n        ...refineCoreProps?.meta,\n      },\n    },\n    ...rest,\n  });\n\n  const {\n    reset,\n    refineCore: { onFinish, id, setId, autoSaveProps },\n    saveButtonProps,\n    handleSubmit,\n  } = useHookFormResult;\n\n  const { visible, show, close } = useModal({\n    defaultVisible,\n  });\n\n  React.useEffect(() => {\n    if (initiallySynced === false && syncWithLocationKey) {\n      const openStatus = parsed?.params?.[syncWithLocationKey]?.open;\n      if (typeof openStatus === \"boolean\") {\n        if (openStatus) {\n          show();\n        }\n      } else if (typeof openStatus === \"string\") {\n        if (openStatus === \"true\") {\n          show();\n        }\n      }\n\n      if (syncingId) {\n        const idFromParams = parsed?.params?.[syncWithLocationKey]?.id;\n        if (idFromParams) {\n          setId?.(idFromParams);\n        }\n      }\n\n      setInitiallySynced(true);\n    }\n  }, [syncWithLocationKey, parsed, syncingId, setId]);\n\n  React.useEffect(() => {\n    if (initiallySynced === true) {\n      if (visible && syncWithLocationKey) {\n        go({\n          query: {\n            [syncWithLocationKey]: {\n              ...parsed?.params?.[syncWithLocationKey],\n              open: true,\n              ...(syncingId && id && { id }),\n            },\n          },\n          options: { keepQuery: true },\n          type: \"replace\",\n        });\n      } else if (syncWithLocationKey && !visible) {\n        go({\n          query: {\n            [syncWithLocationKey]: undefined,\n          },\n          options: { keepQuery: true },\n          type: \"replace\",\n        });\n      }\n    }\n  }, [id, visible, show, syncWithLocationKey, syncingId]);\n\n  const submit = async (values: TVariables) => {\n    await onFinish(values);\n\n    if (autoSubmitClose) {\n      close();\n    }\n\n    if (autoResetForm) {\n      reset();\n    }\n  };\n\n  const { warnWhen, setWarnWhen } = useWarnAboutChange();\n  const handleClose = useCallback(() => {\n    if (\n      autoSaveProps.status === \"success\" &&\n      refineCoreProps?.autoSave?.invalidateOnClose\n    ) {\n      invalidate({\n        id,\n        invalidates: refineCoreProps.invalidates || [\"list\", \"many\", \"detail\"],\n        dataProviderName: refineCoreProps.dataProviderName,\n        resource: identifier,\n      });\n    }\n\n    if (warnWhen) {\n      const warnWhenConfirm = window.confirm(\n        translate(\n          \"warnWhenUnsavedChanges\",\n          \"Are you sure you want to leave? You have unsaved changes.\",\n        ),\n      );\n\n      if (warnWhenConfirm) {\n        setWarnWhen(false);\n      } else {\n        return;\n      }\n    }\n\n    setId?.(undefined);\n    close();\n  }, [warnWhen, autoSaveProps.status]);\n\n  const handleShow = useCallback(\n    (showId?: BaseKey) => {\n      if (typeof showId !== \"undefined\") {\n        setId?.(showId);\n      }\n      const needsIdToOpen = action === \"edit\" || action === \"clone\";\n      const hasId = typeof showId !== \"undefined\" || typeof id !== \"undefined\";\n      if (needsIdToOpen ? hasId : true) {\n        show();\n      }\n    },\n    [id],\n  );\n\n  const title = translate(\n    `${identifier}.titles.${actionProp}`,\n    undefined,\n    `${getUserFriendlyName(\n      `${actionProp} ${\n        resource?.meta?.label ??\n        resource?.options?.label ??\n        resource?.label ??\n        identifier\n      }`,\n      \"singular\",\n    )}`,\n  );\n\n  return {\n    modal: {\n      submit,\n      close: handleClose,\n      show: handleShow,\n      visible,\n      title,\n    },\n    ...useHookFormResult,\n    saveButtonProps: {\n      ...saveButtonProps,\n      onClick: (e) => handleSubmit(submit)(e),\n    },\n  };\n};\n"],"mappings":"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","names":["useEffect","get","has","useHookForm","useFormCore","useWarnAboutChange","useTranslate","useRefineContext","flattenObjectKeys","useForm","__name","refineCoreProps","warnWhenUnsavedChangesProp","disableServerSideValidationProp","rest","options","useRefineContext","disableServerSideValidation","translate","useTranslate","warnWhenUnsavedChangesRefine","setWarnWhen","useWarnAboutChange","warnWhenUnsavedChanges","useHookFormResult","useHookForm","watch","setValue","getValues","handleSubmitReactHookForm","setError","useFormCoreResult","useFormCore","error","_variables","_context","_a","_b","errors","key","flattenObjectKeys","fieldError","newError","query","onFinish","formLoading","onFinishAutoSave","useEffect","data","path","hasValue","has","dataValue","get","subscription","values","type","onValuesChange","changeValues","onFinishProps","handleSubmit","onValid","onInvalid","e","v","useEffect","useState","get","useStepsForm","__name","stepsProps","rest","defaultStep","isBackValidate","current","setCurrent","useState","useHookFormResult","useForm","trigger","getValues","setValue","dirtyFields","query","useEffect","_a","data","registeredFields","key","value","name","get","go","step","targetStep","useCallback","useGo","useModal","useParsed","useResource","useUserFriendlyName","useTranslate","useWarnAboutChange","useInvalidate","React","useModalForm","__name","modalProps","refineCoreProps","syncWithLocation","rest","_a","_b","invalidate","useInvalidate","initiallySynced","setInitiallySynced","React","translate","useTranslate","resourceProp","actionProp","resource","actionFromParams","identifier","useResource","parsed","useParsed","go","useGo","getUserFriendlyName","useUserFriendlyName","action","syncingId","syncWithLocationKey","defaultVisible","autoSubmitClose","autoResetForm","useHookFormResult","useForm","reset","onFinish","id","setId","autoSaveProps","saveButtonProps","handleSubmit","visible","show","close","useModal","_c","_d","openStatus","idFromParams","submit","values","warnWhen","setWarnWhen","useWarnAboutChange","handleClose","useCallback","handleShow","showId","title","e"]}